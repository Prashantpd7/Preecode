<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; img-src {{cspSource}} https: data:; style-src {{cspSource}} https: 'unsafe-inline'; script-src 'nonce-{{nonce}}';" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="{{styleUri}}" />
  <title>Preecode AI</title>
</head>
<body>
  <div class="app" id="app">
    <header class="header">
      <div class="brand">
        <div class="brand-mark">P</div>
        <div class="brand-text">
          <div class="ai-name">Preecode AI</div>
          <div class="ai-tagline">Live coding assistant</div>
        </div>
      </div>
      <div class="header-right">
        <div class="user">
          <span class="status-dot" aria-hidden="true"></span>
          <span class="user-name" id="userName">User</span>
        </div>
        <div class="timer" id="timer">00:00</div>
        <div class="typing" id="typingIndicator">Typing...</div>
      </div>
    </header>

    <section class="monitor-grid">
      <div class="monitor-card">
        <span class="card-label">Active File</span>
        <span class="card-value" id="fileName">No file</span>
      </div>
      <div class="monitor-card">
        <span class="card-label">Language</span>
        <span class="card-value" id="fileLanguage">-</span>
      </div>
      <div class="monitor-card">
        <span class="card-label">Monitor State</span>
        <span class="card-value" id="monitorState">Idle</span>
      </div>
      <div class="monitor-card">
        <span class="card-label">Diagnostics</span>
        <span class="card-value" id="monitorDiagnostics">E:0 W:0</span>
      </div>
      <div class="monitor-card wide">
        <span class="card-label">Selection</span>
        <span class="card-value" id="monitorSelection">No selection</span>
      </div>
      <div class="monitor-card wide">
        <span class="card-label">Visible Range</span>
        <span class="card-value" id="monitorVisibleRange">-</span>
      </div>
      <div class="monitor-card wide issue" id="topIssueCard">
        <span class="card-label">Top Issue Detected</span>
        <span class="card-value" id="monitorTopIssue">No issue detected</span>
      </div>
    </section>

    <section class="actions">
      <button class="action-btn" data-action="debug">
        Debug Code
      </button>
      <button class="action-btn" data-action="fix">
        Fix Code
      </button>
      <button class="action-btn" data-action="explain">
        Explain Code
      </button>
      <button class="action-btn" data-action="line_execution">
        Line-by-line Execution
      </button>
      <button class="action-btn chatbot" data-action="chatbot">
        <span class="chatbot-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" role="img">
            <path d="M7 6.5a5 5 0 0 1 5-5h0a5 5 0 0 1 5 5v1.2a4.8 4.8 0 0 1 3 4.5v2.6a4.7 4.7 0 0 1-4.7 4.7H11l-3.7 2.3c-.6.4-1.3-.1-1.3-.8V19a4.7 4.7 0 0 1-2.7-4.3v-2.5A4.7 4.7 0 0 1 7 7.7V6.5z" fill="currentColor" opacity="0.15" />
            <path d="M8.5 9.5h7M8.5 12.5h5" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" />
            <path d="M14.2 3.8l.6-1.4.6 1.4 1.4.6-1.4.6-.6 1.4-.6-1.4-1.4-.6 1.4-.6z" fill="currentColor" />
          </svg>
        </span>
        AI Chatbot
      </button>
    </section>

    <section class="popup" id="helpPopup" aria-live="polite">
      <div class="popup-text">Take help with Preecode AI?</div>
      <div class="popup-actions">
        <button class="popup-btn" id="helpYes">Yes</button>
        <button class="popup-btn secondary" id="helpLater">Later</button>
      </div>
    </section>

    <section class="output">
      <div class="output-card">
        <div class="output-title">Problem</div>
        <div class="output-body" id="problemOutput">-</div>
      </div>
      <div class="output-card">
        <div class="output-title">Why it happened</div>
        <div class="output-body" id="reasonOutput">-</div>
      </div>
      <div class="output-card">
        <div class="output-title">Problematic part</div>
        <div class="output-body highlight-issue" id="issueHighlightOutput">-</div>
      </div>
      <div class="output-card">
        <div class="output-title">Expected fix</div>
        <div class="output-body highlight-fix" id="expectedFixOutput">-</div>
      </div>
      <div class="output-card">
        <div class="output-title">How to fix</div>
        <div class="output-body" id="stepsOutput">-</div>
      </div>
      <div class="output-card">
        <div class="output-title">Line-by-line execution</div>
        <div class="output-body" id="lineExecutionOutput">-</div>
      </div>
      <div class="output-card">
        <div class="output-title">Fixed code version</div>
        <pre class="output-code" id="fixedCodeOutput">-</pre>
      </div>
      <div class="output-card">
        <div class="output-title">Suggestions</div>
        <div class="output-body" id="suggestionsOutput">-</div>
      </div>
    </section>
  </div>

  <script nonce="{{nonce}}" src="{{scriptUri}}"></script>
</body>
</html>
